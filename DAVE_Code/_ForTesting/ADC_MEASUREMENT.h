#include <Dave.h>
#ifndef _ADC_MEASUREMENT_H_
#define _ADC_MEASUREMENT_H_
/*
 * Sensors gain and bias definition please change
 * accordingly to sensors used.
 */
#define CURRENT_SENS_A_GAIN 0.0f
#define CURRENT_SENS_B_GAIN 0.0f
#define CURRENT_SENS_C_GAIN 0.0f

#define CURRENT_SENS_A_BIAS 0.0f
#define CURRENT_SENS_B_BIAS 0.0f
#define CURRENT_SENS_C_BIAS 0.0f

#define CURRENT_SENS_A_OFFSET 0
#define CURRENT_SENS_B_OFFSET 0
#define CURRENT_SENS_C_OFFSET 0

#define V_DC_SENS_GAIN		1.757505429f  /// VS3000B
#define V_DC_SENS_BIAS 		-218.6629394f    /// VS3000B
#define V_DC_SENS_OFFSET	0

#define RPM_COS_SENS_GAIN 0.0f
#define RPM_SIN_SENS_GAIN 0.0f

#define RPM_COS_SENS_BIAS 0.0f
#define RPM_SIN_SENS_BIAS 0.0f

#define RPM_COS_SENS_OFFSET 0
#define RPM_SIN_SENS_OFFSET 0

/*
 * Not Currently in use
 */
#define TEMP_MOT_SENS_GAIN 0.0f
#define TEMP_MOT_SENS_BIAS 0.0f
#define TEMP_MOT_SENS_OFFSET 0

#define TEMP_IGBT_SENS_GAIN 0.0f
#define TEMP_IGBT_SENS_BIAS 0.0f
#define TEMP_IGBT_SENS_OFFSET 0

/*
 * Un-filtered buffer size and format
 */

float32_t UN_FILT_VALS[8];

#define CURRENT_A_UNFILT UN_FILT_VALS[0]
#define CURRENT_B_UNFILT UN_FILT_VALS[1]
#define CURRENT_C_UNFILT UN_FILT_VALS[2]
#define V_DC_UNFILT UN_FILT_VALS[3]
#define TEMP_SENS_MOT_UNFILT UN_FILT_VALS[4]
#define TEMP_SENS_IGBT_UNFILT UN_FILT_VALS[5]
#define RPM_COS_UNFILT UN_FILT_VALS[6]
#define RPM_SIN_UNFILT UN_FILT_VALS[7]

/*
 * Filtered buffer size and format
 */

float32_t FILT_VALS[8];

#define CURRENT_A FILT_VALS[0]
#define CURRENT_B FILT_VALS[1]
#define CURRENT_C FILT_VALS[2]
#define V_DC_REAL FILT_VALS[3]
#define TEMP_SENS_MOT FILT_VALS[4]
#define TEMP_SENS_IGBT FILT_VALS[5]
#define RPM_COS FILT_VALS[6]
#define RPM_SIN FILT_VALS[7]


/*
 * Filter instances and corresponding coefficients
 */

//Current Sensors Filters
arm_fir_instance_f32 FIR_CURRENT_A;
arm_fir_instance_f32 FIR_CURRENT_B;
arm_fir_instance_f32 FIR_CURRENT_C;

#define FIR_CURRENT_numTaps	91
#define	FIR_CURRENT_blockSize 30

float32_t FIR_CURRENT_A_pState[FIR_CURRENT_numTaps + FIR_CURRENT_blockSize - 1 ];
float32_t FIR_CURRENT_B_pState[FIR_CURRENT_numTaps + FIR_CURRENT_blockSize - 1 ];
float32_t FIR_CURRENT_C_pState[FIR_CURRENT_numTaps + FIR_CURRENT_blockSize - 1 ];

//Speed Sensor Filters
arm_fir_instance_f32 FIR_RPM_COS;
arm_fir_instance_f32 FIR_RPM_SIN;

#define FIR_RPM_numTaps	101
#define	FIR_RPM_blockSize 1

float32_t FIR_RPM_COS_pState[FIR_RPM_numTaps + FIR_RPM_blockSize - 1 ];
float32_t FIR_RPM_SIN_pState[FIR_RPM_numTaps + FIR_RPM_blockSize - 1 ];

//Voltage Sensor Filter
arm_fir_instance_f32 FIR_V_DC;

#define FIR_V_DC_numTaps	103
#define	FIR_V_DC_blockSize 1

float32_t FIR_V_DC_pState[FIR_V_DC_numTaps + FIR_V_DC_blockSize - 1 ];

/*
 * Filter coefficients
 */
const float32_t FIR_V_DC_pCoeffs[FIR_V_DC_numTaps] =
{

};

const float32_t FIR_RPM_pCoeffs[FIR_RPM_numTaps] =
{

};

const float32_t FIR_CURRENT_pCoeffs[FIR_CURRENT_numTaps] =
{
		0.003960123645219768,
		  -0.0012349657854426328,
		  -0.0018597905165904094,
		  -0.0022824467080622634,
		  -0.001955166564667548,
		  -0.0007200923411162917,
		  0.001032383623214299,
		  0.0024871017430934065,
		  0.0027986013668364314,
		  0.001574358175793948,
		  -0.0008078492628250619,
		  -0.0032593520698802956,
		  -0.004449159730031383,
		  -0.0034931999322872272,
		  -0.0005194575399478046,
		  0.003224897871712942,
		  0.005859923372530622,
		  0.005785232409141635,
		  0.0025886020872344906,
		  -0.002537965208637225,
		  -0.0071774896909329354,
		  -0.008774624630037205,
		  -0.005977680353033441,
		  0.00046044766460577905,
		  0.007703333955579813,
		  0.012062998491777277,
		  0.010735853659773711,
		  0.0034636305517953695,
		  -0.006927765440255964,
		  -0.01548376815039915,
		  -0.017338566690925438,
		  -0.010254516471484797,
		  0.003748446733120727,
		  0.0186417148251891,
		  0.02669590315715992,
		  0.022056508921760917,
		  0.004073800263286028,
		  -0.021219576883762952,
		  -0.042443601851235364,
		  -0.046819576227324564,
		  -0.025341599199746524,
		  0.022898175603775314,
		  0.08913649885465669,
		  0.15701167048935047,
		  0.2077400200232294,
		  0.22651403498747746,
		  0.2077400200232294,
		  0.15701167048935047,
		  0.08913649885465669,
		  0.022898175603775314,
		  -0.025341599199746524,
		  -0.046819576227324564,
		  -0.042443601851235364,
		  -0.021219576883762952,
		  0.004073800263286028,
		  0.022056508921760917,
		  0.02669590315715992,
		  0.0186417148251891,
		  0.003748446733120727,
		  -0.010254516471484797,
		  -0.017338566690925438,
		  -0.01548376815039915,
		  -0.006927765440255964,
		  0.0034636305517953695,
		  0.010735853659773711,
		  0.012062998491777277,
		  0.007703333955579813,
		  0.00046044766460577905,
		  -0.005977680353033441,
		  -0.008774624630037205,
		  -0.0071774896909329354,
		  -0.002537965208637225,
		  0.0025886020872344906,
		  0.005785232409141635,
		  0.005859923372530622,
		  0.003224897871712942,
		  -0.0005194575399478046,
		  -0.0034931999322872272,
		  -0.004449159730031383,
		  -0.0032593520698802956,
		  -0.0008078492628250619,
		  0.001574358175793948,
		  0.0027986013668364314,
		  0.0024871017430934065,
		  0.001032383623214299,
		  -0.0007200923411162917,
		  -0.001955166564667548,
		  -0.0022824467080622634,
		  -0.0018597905165904094,
		  -0.0012349657854426328,
		  0.003960123645219768
};

#endif
